<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>KNOWLEDGE-MAP EXPLORER v3.14</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrqObt3b/m58h4iK3+l8v/2f/B2R0JvT12gD4t8eF/W0FpGvM/0D/K9/G1z/Jv0" crossorigin="anonymous">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles_2.css') }}">

</head>
<body>
<div class="status-bar"></div>
<div class="container-fluid py-3">
  <!-- Top Heading -->
  <nav class="navbar navbar-expand-lg mb-3 position-relative overflow-hidden">
    <div class="container-fluid position-relative z-1">

      <!-- Brand -->
      <a class="navbar-brand cyber-font d-flex align-items-center text-decoration-none" href="#" id="home-link">
        <i class="bi bi-cpu-fill me-2 animate-glow"></i>
        <span class="d-none d-sm-inline">KNOWLEDGE-MAP EXPLORER</span>
        <span class="d-inline d-sm-none">KME</span>
        <small class="ms-2 text-accent-cyan opacity-75">v3.14</small>
      </a>

      <!-- Discover / Popular buttons -->
      <div class="d-flex align-items-center ms-3 gap-2">
        <button class="btn btn-outline-primary cyber-font btn-glow" id="discover-btn">
          <i class="bi bi-compass me-1"></i> DISCOVER
        </button>
        <button class="btn btn-outline-primary cyber-font btn-glow" id="popular-btn">
          <i class="bi bi-star-fill me-1"></i> POPULAR
        </button>
      </div>

      <!-- Search bar (centered) -->
      <div class="mx-auto w-100 w-md-50">
        <div class="input-group input-group-glow">
          <span class="input-group-text bg-card border-0 text-accent-blue">
            <i class="bi bi-terminal"></i>
          </span>

          <input type="text"
                id="search-bar"
                class="form-control cyber-font bg-card border-0 text-primary placeholder-muted"
                placeholder="SEARCH NODES..."
                autocomplete="off">

          <span class="input-group-text bg-card border-0">
            <span class="cursor"></span>
          </span>
        </div>
      </div>

    </div>

    <!-- Animated scan-line overlay (pure CSS) -->
    <div class="navbar-scan-line"></div>
  </nav>

  <!-- Options Bar -->
  <div class="d-flex justify-content-between align-items-center mt-3">
    <div>
      <button class="btn btn-outline-primary me-2 cyber-font" id="back-btn">
        <i class="bi bi-arrow-left-circle-fill me-1"></i> BACK
      </button>
      <button class="btn btn-outline-primary cyber-font" id="forward-btn">
        <i class="bi bi-arrow-right-circle-fill me-1"></i> FWD
      </button>
      <button class="btn btn-outline-primary cyber-font" id="workflow-btn">
        <i class="bi bi-lightbulb-fill me-1"></i> SUGGESTION
      </button>
    </div>

    <!-- Workflow Overlay -->
    <div id="workflow-overlay" style="display:none; position:fixed; inset:0; z-index:2000; align-items:center; justify-content:center; background:rgba(0,0,0,0.6);">
      <div id="workflow-modal" style="position:relative; width:100%; max-width:900px; margin:16px; background:#0b0b0b; color:#fff; border:1px solid rgba(0,200,255,0.25); border-radius:8px; padding:20px; box-shadow:0 8px 30px rgba(0,0,0,0.6); transform-origin:center center; transform:scale(0.85); opacity:0; transition:transform 180ms ease, opacity 180ms ease;">
        <button id="workflow-close" aria-label="Close" style="position:absolute; top:10px; right:10px; background:blue; border:none; color:#fff; font-size:2.25rem; cursor:pointer;">&times;</button>

        <!-- Inner HTML region (place dynamic content here) -->
        <div id="workflow-content" style="min-height:120px; max-height:70vh; overflow-y:auto; padding-right:8px; box-sizing:border-box;">
          <div class="container-fluid p-0" style="background: linear-gradient(135deg, #0a1929 0%, #1a365d 100%); min-height: 100vh; color: #e2e8f0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
            <div class="container py-5">
              
              <!-- Header Section -->
              <header class="text-center mb-5" style="border-bottom: 1px solid #2d3748; padding-bottom: 2rem;">
                <h1 class="display-4 fw-bold mb-3" style="color: #63b3ed; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                  üìù Markdown to HTML Workflow
                </h1>
                <p class="lead" style="color: #a0aec0;">
                  Convert your AI-generated markdown into beautiful HTML articles
                </p>
              </header>

              <!-- Workflow Steps -->
              <div class="row justify-content-center">
                <div class="col-lg-10">
                  
                  <!-- Step 1 -->
                  <div class="workflow-step mb-5 p-4 rounded" style="background-color: rgba(26, 32, 44, 0.7); border-left: 4px solid #4299e1;">
                    <div class="step-header d-flex align-items-center mb-3">
                      <span class="step-number me-3 d-flex align-items-center justify-content-center rounded-circle" style="width: 40px; height: 40px; background: #4299e1; color: white; font-weight: bold;">
                        1
                      </span>
                      <h3 class="mb-0" style="color: #90cdf4;">Get Markdown from AI</h3>
                    </div>
                    <p class="mb-3" style="color: #cbd5e0;">
                      Obtain markdown content from ChatGPT, DeepSeek, Gemini, or any other AI assistant
                    </p>
                    <div class="step-content">
                      <div class="bg-dark p-3 rounded" style="border: 1px solid #2d3748;">
                        <h6 class="mb-2" style="color: #63b3ed;">Example Markdown:</h6>
                        <code style="color: #68d391; display: block; white-space: pre-wrap;">
          # Article Title

          ## Introduction
          This is a sample markdown content...

          - Point 1
          - Point 2
          - Point 3

          **Bold text** and *italic text*
                        </code>
                      </div>
                    </div>
                  </div>

                  <!-- Step 2 -->
                  <div class="workflow-step mb-5 p-4 rounded" style="background-color: rgba(26, 32, 44, 0.7); border-left: 4px solid #48bb78;">
                    <div class="step-header d-flex align-items-center mb-3">
                      <span class="step-number me-3 d-flex align-items-center justify-content-center rounded-circle" style="width: 40px; height: 40px; background: #48bb78; color: white; font-weight: bold;">
                        2
                      </span>
                      <h3 class="mb-0" style="color: #90cdf4;">Convert to HTML using DeepSeek</h3>
                    </div>
                    <p class="mb-3" style="color: #cbd5e0;">
                      Use DeepSeek or similar AI to convert your markdown into clean HTML code
                    </p>
                    <div class="step-content">
                      <div class="row">
                        <div class="col-md-6 mb-3">
                          <h6 class="mb-2" style="color: #63b3ed;">Input to DeepSeek:</h6>
                          <div class="bg-dark p-3 rounded" style="border: 1px solid #2d3748; min-height: 120px;">
                            <code style="color: #68d391;">
          Convert this markdown to HTML with proper styling:

          [Your markdown content here...]
                            </code>
                          </div>
                        </div>
                        <div class="col-md-6 mb-3">
                          <h6 class="mb-2" style="color: #63b3ed;">Expected Output:</h6>
                          <div class="bg-dark p-3 rounded" style="border: 1px solid #2d3748; min-height: 120px;">
                            <code style="color: #68d391;">
          &lt;div class="article"&gt;
            &lt;h1&gt;Article Title&lt;/h1&gt;
            &lt;h2&gt;Introduction&lt;/h2&gt;
            &lt;p&gt;This is a sample HTML content...&lt;/p&gt;
          &lt;/div&gt;
                            </code>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Step 3 -->
                  <div class="workflow-step mb-5 p-4 rounded" style="background-color: rgba(26, 32, 44, 0.7); border-left: 4px solid #ed8936;">
                    <div class="step-header d-flex align-items-center mb-3">
                      <span class="step-number me-3 d-flex align-items-center justify-content-center rounded-circle" style="width: 40px; height: 40px; background: #ed8936; color: white; font-weight: bold;">
                        3
                      </span>
                      <h3 class="mb-0" style="color: #90cdf4;">Paste HTML Here</h3>
                    </div>
                    <p class="mb-3" style="color: #cbd5e0;">
                      Insert the converted HTML into your website with the dark blueish theme
                    </p>
                    <div class="step-content">
                      <div class="bg-dark p-3 rounded" style="border: 1px solid #2d3748;">
                        <h6 class="mb-2" style="color: #63b3ed;">Final HTML Integration:</h6>
                        <code style="color: #68d391; display: block; white-space: pre-wrap;">
          // Wrap your HTML content with this dark theme container
          &lt;div class="container-fluid p-0" style="background: linear-gradient(135deg, #0a1929 0%, #1a365d 100%);"&gt;
            &lt;div class="container py-5"&gt;
              [Your converted HTML content here...]
            &lt;/div&gt;
          &lt;/div&gt;
                        </code>
                      </div>
                    </div>
                  </div>

                  <!-- Quick Tips Section -->
                  <div class="mt-5 p-4 rounded" style="background-color: rgba(26, 32, 44, 0.7); border: 1px solid #2d3748;">
                    <h4 class="mb-3" style="color: #63b3ed;">üí° Quick Tips</h4>
                    <div class="row">
                      <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-start">
                          <span class="me-3" style="color: #48bb78;">‚úì</span>
                          <div>
                            <h6 style="color: #90cdf4;">Keep Markdown Clean</h6>
                            <p class="small mb-0" style="color: #a0aec0;">
                              Ensure your markdown is well-structured with proper headings and formatting
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-start">
                          <span class="me-3" style="color: #48bb78;">‚úì</span>
                          <div>
                            <h6 style="color: #90cdf4;">Specify Styling</h6>
                            <p class="small mb-0" style="color: #a0aec0;">
                              Ask the AI to include inline styles for the dark blueish theme
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-start">
                          <span class="me-3" style="color: #48bb78;">‚úì</span>
                          <div>
                            <h6 style="color: #90cdf4;">Test Responsiveness</h6>
                            <p class="small mb-0" style="color: #a0aec0;">
                              Verify the HTML works well on different screen sizes
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-start">
                          <span class="me-3" style="color: #48bb78;">‚úì</span>
                          <div>
                            <h6 style="color: #90cdf4;">Optimize Content</h6>
                            <p class="small mb-0" style="color: #a0aec0;">
                              Remove unnecessary elements and keep the focus on content
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Sample Output Preview -->
                  <div class="mt-5 p-4 rounded" style="background-color: rgba(26, 32, 44, 0.7); border: 1px solid #2d3748;">
                    <h4 class="mb-3" style="color: #63b3ed;">üéØ Sample Output Preview</h4>
                    <div class="bg-dark p-4 rounded" style="border: 1px solid #2d3748;">
                      <h5 style="color: #63b3ed;">Converted Article Preview</h5>
                      <p style="color: #cbd5e0;">
                        This is how your converted markdown will look with the dark blueish theme...
                      </p>
                      <div class="mt-3 p-3 rounded" style="background-color: #2d3748;">
                        <h6 style="color: #90cdf4;">Sample Heading</h6>
                        <p class="mb-2" style="color: #a0aec0;">
                          This is a sample paragraph showing the color scheme and typography.
                        </p>
                        <ul style="color: #a0aec0;">
                          <li>List item with proper contrast</li>
                          <li>Readable text on dark background</li>
                          <li>Professional appearance</li>
                        </ul>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(){
        var btn = document.getElementById('workflow-btn');
        var overlay = document.getElementById('workflow-overlay');
        var modal = document.getElementById('workflow-modal');
        var close = document.getElementById('workflow-close');

        // Inline-style event listener attached to the workflow button
        btn.onclick = function () {
          if (overlay.style.display === 'flex') {
            // hide
            modal.style.transform = 'scale(0.85)';
            modal.style.opacity = '0';
            setTimeout(function(){ overlay.style.display = 'none'; }, 200);
          } else {
            // show (centered, expands from center)
            overlay.style.display = 'flex';
            // allow layout then animate
            setTimeout(function(){
              modal.style.transform = 'scale(1)';
              modal.style.opacity = '1';
            }, 10);
          }
        };

        close.onclick = function () {
          modal.style.transform = 'scale(0.85)';
          modal.style.opacity = '0';
          setTimeout(function(){ overlay.style.display = 'none'; }, 200);
        };

        // click on backdrop closes overlay
        overlay.addEventListener('click', function(e){
          if (e.target === overlay) {
            modal.style.transform = 'scale(0.85)';
            modal.style.opacity = '0';
            setTimeout(function(){ overlay.style.display = 'none'; }, 200);
          }
        });
      })();
    </script>

    <div id="map-options" class="d-none">
      <div class="btn-group me-2">
        <button class="btn btn-primary dropdown-toggle cyber-font" data-bs-toggle="dropdown">
          <i class="bi bi-plus-circle me-1"></i> ADD PAGE
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#addExistingPageModal">
            <i class="bi bi-file-earmark-plus me-1"></i> EXISTING PAGE
          </a></li>
          <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#createPageModal">
            <i class="bi bi-file-earmark-code me-1"></i> NEW PAGE
          </a></li>
        </ul>
      </div>
      <button class="btn btn-primary cyber-font" data-bs-toggle="modal" data-bs-target="#createMapModal">
        <i class="bi bi-diagram-3 me-1"></i> NEW MAP
      </button>
    </div>
    <div id="page-options" class="d-none">
      <div class="btn-group me-2">
        <button id="stateSelectDropdown"
                class="btn btn-primary dropdown-toggle cyber-font"
                type="button"
                data-bs-toggle="dropdown"
                aria-expanded="false">
          Select an Option
        </button>
        <!-- Menu Placeholder (will be filled dynamically) -->
        <ul class="dropdown-menu" aria-labelledby="stateSelectDropdown"></ul>
      </div>

      <button id="page-delete-btn" class="btn btn-danger cyber-font">
        <i class="bi bi-trash-fill me-1"></i> DELETE
      </button>

      <button id="page-edit-btn" class="btn btn-primary cyber-font me-2">
        <i class="bi bi-pencil-square me-1"></i> EDIT
      </button>
      <button class="btn btn-primary cyber-font me-2" data-bs-toggle="modal" data-bs-target="#addKeywordModal">
        <i class="bi bi-tags-fill me-1"></i> ADD TAGS
      </button>
      <button class="btn btn-primary cyber-font me-2" id="latex-cleaner-btn">
        <i class="bi bi-eraser-fill me-1"></i> LATEX CLEANER
      </button>
    </div>
  </div>

  <!-- Content Container -->
  <div id="content-container" class="mt-3">
    <div class="grid-overlay"></div>
    <!-- Dynamic content loaded here -->
    <div class="d-flex justify-content-center align-items-center h-100">
      <div class="text-center">
        <i class="bi bi-hdd-stack" style="font-size: 3rem; color: var(--neon-blue);"></i>
        <p class="mt-3 cyber-font">SYSTEM READY</p>
        <p class="text-muted">AWAITING USER COMMAND</p>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="mt-4 text-center cyber-font">
    <small>SYSTEM STATUS: <span class="text-success">ONLINE</span> | MEMORY USAGE: 78% | NETWORK: STABLE</small>
  </footer>
</div>

<!-- All Modals Below -->

<!-- Keyword Modal -->
<div class="modal fade" id="addKeywordModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title cyber-font"><i class="bi bi-tags-fill me-2"></i>ADD TAGS</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <label class="input-label">TAG INPUT</label>
        <input type="text" id="keyword-input" class="form-control" placeholder="ENTER TAGS, SEPARATED BY COMMAS">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary cyber-font" data-bs-dismiss="modal">CANCEL</button>
        <button class="btn btn-primary cyber-font" onclick="submitKeywords()">CONFIRM</button>
      </div>
    </div>
  </div>
</div>

<!-- Existing Page Modal -->
<div class="modal fade" id="addExistingPageModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title cyber-font"><i class="bi bi-files me-2"></i>LINK EXISTING PAGES</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <label class="input-label">SEARCH QUERY</label>
        <input type="text" id="existing-page-search" class="form-control" placeholder="ENTER SEARCH PARAMETERS">
        <label class="input-label mt-3">SEARCH RESULTS</label>
        <div id="existing-page-results" class="mt-2 p-2" style="
          background-color: rgba(0,0,0,0.3); 
          border: 1px solid var(--neon-blue);
          min-height: 200px;
        ">
          <div class="text-center text-muted py-5">
            <i class="bi bi-search" style="font-size: 2rem;"></i>
            <p class="mt-2">NO RESULTS TO DISPLAY</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary cyber-font" data-bs-dismiss="modal">ABORT</button>
        <button class="btn btn-primary cyber-font" onclick="submitExistingPages()">LINK SELECTED</button>
      </div>
    </div>
  </div>
</div>

<!-- Create Page Modal -->
<div class="modal fade" id="createPageModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title cyber-font"><i class="bi bi-file-earmark-plus me-2"></i>CREATE NEW PAGE</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <label class="input-label">PAGE TITLE</label>
        <input type="text" id="new-page-title" class="form-control mb-3" placeholder="ENTER PAGE TITLE">
        <label class="input-label">CONTENT</label>
        <textarea id="new-page-content" class="form-control" placeholder="ENTER PAGE CONTENT" rows="6"></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary cyber-font" data-bs-dismiss="modal">CANCEL</button>
        <button class="btn btn-success cyber-font" onclick="submitNewPage()">COMPILE</button>
      </div>
    </div>
  </div>
</div>

<!-- Create Map Modal -->
<div class="modal fade" id="createMapModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title cyber-font"><i class="bi bi-diagram-3 me-2"></i>CREATE NEW MAP</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <label class="input-label">MAP IDENTIFIER</label>
        <input type="text" id="new-map-title" class="form-control" placeholder="ENTER MAP TITLE">
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary cyber-font" data-bs-dismiss="modal">ABORT</button>
        <button class="btn btn-primary cyber-font" onclick="submitNewMap()">INITIALIZE</button>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='CRUD_utils.js') }}"></script>
<script src="{{ url_for('static', filename='editor.js') }}"></script>
<script src="{{ url_for('static', filename='script.js') }}"></script>

<script>
  // Add terminal-like typing effect to search placeholder
  const searchBar = document.getElementById('search-bar');
  const placeholders = [
    "SEARCH NODES...",
    "QUERY DATABASE...", 
    "ANALYZE STRUCTURE...",
    "SCAN NETWORK..."
  ];
  let currentPlaceholder = 0;
  
  function cyclePlaceholder() {
    searchBar.placeholder = placeholders[currentPlaceholder];
    currentPlaceholder = (currentPlaceholder + 1) % placeholders.length;
  }
  
  setInterval(cyclePlaceholder, 3000);
</script>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="confirmDeleteLabel">Confirm Delete</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body text-center">
        <p class="mb-0">Are you sure you want to delete this page?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button id="confirm-delete-btn" type="button" class="btn btn-danger">Delete</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>