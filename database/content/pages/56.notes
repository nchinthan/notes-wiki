<div class="markdown prose dark:prose-invert w-full break-words dark"><p data-start="0" data-end="131" class="">Nice follow-up! You're close ‚Äî let's walk through it and clear up the confusion around <strong data-start="87" data-end="130">where KL divergence is applied in a VAE</strong>.</p>
<hr data-start="133" data-end="136" class="" style="">
<h3 data-start="138" data-end="162" class="">üîÅ VAE Flow in Brief</h3>
<p data-start="164" data-end="174" class="">Let‚Äôs say:</p>
<ul data-start="175" data-end="283">
<li data-start="175" data-end="200" class="" style="">
<p data-start="177" data-end="200" class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span></span></span> = observed data</p>
</li>
<li data-start="201" data-end="229" class="" style="">
<p data-start="203" data-end="229" class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span> = latent variables</p>
</li>
<li data-start="230" data-end="283" class="" style="">
<p data-start="232" data-end="283" class="">We want to model <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span>, the data distribution.</p>
</li>
</ul>
<p data-start="285" data-end="428" class="">Since directly modeling <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>‚à´</mo><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mi mathvariant="normal">‚à£</mi><mi>Z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mtext>&thinsp;</mtext><mi>d</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">p(X) = \int p(X|Z)p(Z)\,dZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" s="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.1111em; vertical-align: -0.3061em;"></span><span class="mop op-symbol small-op" style="margin-right: 0.19445em; position: relative; top: -0.0006em;">‚à´</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span> is hard, we introduce an <strong data-start="367" data-end="392">approximate posterior</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" st"margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span> using the <strong data-start="416" data-end="427">encoder</strong>.</p>
<hr data-start="430" data-end="433" class="" style="">
<h3 data-start="435" data-end="466" class="">üß† VAE Loss Function (ELBO)</h3>
<span class="katex-display" style=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>log</mi><mo>‚Å°</mo><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>‚â•</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>‚Å°</mo><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mi mathvariant="normal">‚à£</mi><mi>Z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>‚àí</mo><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo>tretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo><mo>‚à•</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log p(X) \geq \mathbb{E}_{q(Z|X)}[\log p(X|Z)] - D_{\text{KL}}(q(Z|X) \parallel p(Z))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚â•</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" styleht: 1.1052em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">Z</span><span class="mord mtight">‚à£</span><span class="mord mathnormal mtight" style="margin-right: 0.07847em;">X</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-rig: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class=d text mtight"><span class="mord mtight">KL</span></span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚à•</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">))</span></span></span></span></span>
<pa-start="562" data-end="586" class="">This gives us two parts:</p>
<ol data-start="588" data-end="962">
<li data-start="588" data-end="762" class="" style="">
<p data-start="591" data-end="661" class=""><strong data-start="591" data-end="614">Reconstruction Loss</strong><br data-start="614" data-end="617">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">E</mi><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>log</mi><mo>‚Å°</mo><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mi mathvariant="normal">‚à£</mi><mi>Z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{E}_{q(Z|X)}[\log p(X|Z)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.1052em; al-align: -0.3552em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right: 0.07153em;">Z</span><span class="mord mtight">‚à£</span><span class="mord mathnormal mtight" style="margin-right: 0.07847em;">X</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-right: 0.01389em;">g</sn></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)]</span></span></span></span>:</p>
<ul data-start="665" data-end="762">
<li data-start="665" data-end="683" class="" style="">
<p data-start="667" data-end="683" class="">From <strong data-start="672" data-end="683">decoder</strong></p>
</li>
<li data-start="687" data-end="762" class="" style="">
<p data-start="689" data-end="762" class="">Encourages reconstructions of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></sp><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span></span></span></span> to be accurate from sampled <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span></p>
</li>
</ul>
</li>
<li data-start="764" data-end="962" class="" style="">
<p data-start="767" data-end="835" class=""><strong data-start="767" data-end="784">KL Divergence</strong><br data-start="784" data-end="787">
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mX</mi><mo stretchy="false">)</mo><mo>‚à•</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{\text{KL}}(q(Z|X) \parallel p(Z))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">KL</span></span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 05em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚à•</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">))</span></span></span></span>:</p>
<ul data-start="839" data-end="962">
<li data-start="839" data-end="857" class="" style="">
<p data-start="841" data-end="857" class="">From <strong data-start="846" data-end="857">encoder</strong></p>i>
<li data-start="861" data-end="962" class="" style="">
<p data-start="863" data-end="962" class="">Encourages <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span> to stay close to a <strong data-start="906" data-end="922">simple prior</strong>, usually <span class="katex"><span class="katex-ma"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z) = \mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mclose">)</span></span></span></span></p>
</li>
</ul>
</li>
</ol>
<hr data-start="964" data-end="967" class="" style="">
<h3 data-start="969" data-end="1000" class="">‚úÖ What KL Is Actually Doing</h3>
<h4 data-start="1002" data-end="1025" class="">üî∂ <strong data-start="1010" data-end="1025">In Encoder:</strong></h4>
<ul data-start="1026" data-end="1270">
<li data-start="1026" data-end="1074" class="" style="">
<p data-start="1028" data-end="1074" class="">We compute <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X)</annotation></semantics></math></span><span class-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span>, the encoder's output.</p>
</li>
<li data-start="1075" data-end="1135" class="" style="">
<p data-start="1077" data-end="1086" class="">We apply:</p>
<span class="katex-display" style=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo><mo>‚à•</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</motretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{\text{KL}}(q(Z|X) \parallel p(Z))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">KL</span></span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚à•</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">))</span></span></span></span></span>
</li>
<li data-start="1136" data-end="1210" class="" style="">
<p data-start="1138" data-end="1210" class="">This pushes the <strong data-start="1154" data-end="1180">posterior distribution</strong> to be close to the <strong data-start="1200" data-end="1209">prior</strong>.</p>
</li>
<li data-start="1211" data-end="127lass="" style="">
<p data-start="1213" data-end="1270" class="">Makes sampling from the latent space easier at inference.</p>
</li>
</ul>
<h4 data-start="1272" data-end="1295" class="">üî∑ <strong data-start="1280" data-end="1295">In Decoder:</strong></h4>
<ul data-start="1296" data-end="1483">
<li data-start="1296" data-end="1360" class="" style="">
<p data-start="1298" data-end="1360" class="">We reconstruct <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span></span></span></span> from sampled <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</anation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span></span></span></span>, i.e. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mi mathvariant="normal">‚à£</mi><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(X|Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span></p>
</li>
<li data-start="1361ta-end="1388" class="" style="">
<p data-start="1363" data-end="1388" class="">No KL term here directly.</p>
</li>
<li data-start="1389" data-end="1483" class="" style="">
<p data-start="1391" data-end="1403" class="">The loss is:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>‚àí</mo><mi>log</mi><mo>‚Å°</mo><mi>p</mi><mo stretchy="false">(</mo><mi>X</mi><mi mathvariant="normal">‚à£</mi><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">-\log p(X|Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">‚àí</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mat>p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span></span>
<p data-start="1431" data-end="1483" class="">(like MSE or binary cross-entropy depending on data)</p>
</li>
</ul>
<hr data-start="1485" data-end="1488" class="" style="">
<h3 data-start="1490" data-end="1507" class="">‚ö†Ô∏è To Clarify</h3>
<div class="overflow-x-auto contain-inline-size"><table data-start="1509" data-end="1709" node="[object Object]"><thead data-start="1509" data-end="1555"><tr data-start="1509" data-end="1555"><th data-start="1509" data-end="1521">Step</th><th data-start="1521" data-end="1536">Distribution</th><th data-start="1536" data-end="1555">Divergence Used</th></tr></thead><tbody data-start="1604" data-end="1709"><tr data-start="1604" data-end="1651"><td>Encoder</td><td>( q(Z</td><td>X) )</td></tr><tr data-start="1652" da="1709"><td>Decoder</td><td>( p(X</td><td>Z) )</td></tr></tbody></table></div>
<p data-start="1711" data-end="1716" class="">So:</p>
<blockquote data-start="1717" data-end="1784">
<p data-start="1719" data-end="1784" class="">‚ùå Not KL(Z‚ÄñX) or KL(Y‚ÄñZ)<br data-start="1743" data-end="1746">
‚úÖ But KL(q(Z‚ÄñX) ‚Äñ p(Z)) is minimized</p>
</blockquote>
<hr data-start="1786" data-end="1789" class="" style="">
<p data-start="1791" data-end="1880" class="">Let me know if you want a diagram of this process, or the PyTorch loss formula for a VAE!</p></div><div class="markdown prose dark:prose-invert w-full break-words dark"><p data-start="0" data-end="107" class="">That‚Äôs a really good intuition ‚Äî and you're absolutely right to question this. Let's break it down clearly:</p>
<hr data-start="109" data-end="112" class="" style="">
<h3 data-start="114" data-end="154" class="">ü§î So‚Ä¶ we <strong data-start="128" data-end="142">don‚Äôt know</strong> <span class="katex"><span class="katex-mathml"><math xmlns="htth/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span>?</h3>
<p data-start="156" data-end="241" class="">Actually:<br data-start="165" data-end="168">
‚û°Ô∏è We <strong data-start="174" data-end="184">assume</strong> a simple prior for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><spaass="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span> ‚Äî <strong data-start="217" data-end="240">we pick it manually</strong>.</p>
<h3 data-start="243" data-end="260" class="">üìå Typically:</h3>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z) = \mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mclose">)</span></span></span></span></span>
<p data-start="292" data-end="442" class="">A standard multivariate Gaussian.<br data-start="325" data-end="328">
It‚Äôs not learned ‚Äî <strong data-start="347" data-end="371">it‚Äôs a design choice</strong>. This makes the KL divergence <strong data-start="402" nd="415">tractable</strong> (analytically computable).</p>
<hr data-start="444" data-end="447" class="" style="">
<h3 data-start="449" data-end="471" class="">üîç Why is that OK?</h3>
<p data-start="473" data-end="481" class="">In VAEs:</p>
<ul data-start="482" data-end="663">
<li data-start="482" data-end="552" class="" style="">
<p data-start="484" data-end="552" class="">We <strong data-start="487" data-end="515">don‚Äôt model <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z<span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span></strong> (true posterior) ‚Äî it's intractable.</p>
</li>
<li data-start="553" data-end="612" class="" style="">
<p data-start="555" data-end="612" class="">We <strong data-start="558" data-end="573">approximate</strong> it using <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="m</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span> via the encoder.</p>
</li>
<li data-start="613" data-end="663" class="" style="">
<p data-start="615" data-end="663" class="">The goal is to make <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo><mo>‚âà</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X) \approx p(Z|X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-rig07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span></span></span></span>.</p>
</li>
</ul>
<p data-start="665" data-end="851" class="">But we <strong data-start="672" data-end="694">need a regularizer</strong> to keep the latent space organized.<br data-start="730" data-end="733">
So we introduce <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span> (the prior), which we <strong data-start="782" data-end="802">define ourselves</strong> ‚Äî usually something simple like standard normal.</p>
<p data-start="853" data-end="890" class="">This is what makes the KL divergence:</p>
<span class="katex-display" style=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>D</mi><mtext>KL</mtext></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mimi><mo stretchy="false">)</mo><mo>‚à•</mo><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{\text{KL}}(q(Z|X) \parallel p(Z))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3283em;"><span style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">KL</span></span></span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">‚à•</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">))</span></span></span></span></span>
<p data-start="934" data-end="984" class=""><strong data-start="934" data-end="961">analytically computable</strong> if both are Gaussians.</p>
<hr data-start="986" data-end="989" class="" style="">
<h3a-start="991" data-end="1006" class="">üî¢ Example:</h3>
<p data-start="1008" data-end="1018" class="">Let‚Äôs say:</p>
<ul data-start="1019" data-end="1112">
<li data-start="1019" data-end="1079" class="" style="">
<p data-start="1021" data-end="1079" class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>Z</mi><mi mathvariant="normal">‚à£</mi><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mi>Œº</mi><mo separator="true">,</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(Z|X) = \mathcal{N}(\mu, \sigma^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mopen">(</span><span cd mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mord">‚à£</span><span class="mord mathnormal" style="margin-right: 0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord mathnormal">Œº</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">œÉ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mmtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> from the encoder</p>
</li>
<li data-start="1080" data-end="1112" class="" style="">
<p data-start="1082" data-end="1112" class=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z) = \mathcal{N}(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
</ul>
<p data-start="1114" data-end="1145" class="">Then the KL divergence becomes:</p>
<span class="katex-display" style=""><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚àë</mo><mrow><mo fence="true">(</mo><msup><mi>Œº</mi><mn>2</mn></msup><mo>+</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo>‚àí</mo><mi>log</mi><mo>‚Å°</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo>‚àí</mo><mn>1</mn><mo fence="trumrow></mrow><annotation encoding="application/x-tex">\frac{1}{2} \sum \left( \mu^2 + \sigma^2 - \log \sigma^2 - 1 \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.0074em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3214em;"><span style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&ZeroWidthSpace;</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop op-symbol large-op" style="position: relative; top: 0em;">‚àë</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">Œº</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord mathnormal" sty"margin-right: 0.03588em;">œÉ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03588em;">œÉ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8641em;"><span style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span classrd mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span>
<p data-start="1222" data-end="1282" class="">This can be computed exactly, and used in the loss function.</p>
<hr data-start="1284" data-end="1287" class="" style="">
<h3 data-start="1289" data-end="1303" class="">‚úÖ Summary:</h3>
<div class="overflow-x-auto contain-inline-size"><table data-start="1305" data-end="1634" node="[object Object]"><thead data-start="1305" data-end="1330"><tr data-start="1305" data-end="1330"><th data-start="1305" data-end="1315">Concept</th><th data-start="1315" data-end="1330">What's done</th></tr></thead><tbody data-start="1356" data-end="1634"><tr data-start="1356" data-end="1424"><td><span class="katex">< class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(Z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.07153em;">Z</span><span class="mclose">)</span></span></span></span></td><td>We <strong data-start="1374" data-end="1384">choose</strong> it, typically <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{N}(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathcal" style="margin-right: 0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.07847em;">I</span><span class="mclose">)</span></span></span></span></td></tr><tr data-start="1425" data-end="1464"><td>( q(Z</td><td>X) )</td></tr><tr data-start="1465" data-end="1533"><td>KL Divergence</td><td>Measures how close ( q(Z</td></tr><tr data-start="1534" data-end="1634"><td>Why?</td><td>To make the latent space <strong data-start="1568" data-end="1594">smooth and regularized</strong>, and enable <strong data-start="1607" data-end="1632">sampling at inference</strong></td></tr></tbody></table></div>
<hr data-start="1636" data-end="1639" class="" style="">
<p data-start="1641" data-end="1754" class="">Let me know if you want to visualize how this affects the latent space or how sampling works during generation üëá</p></div>