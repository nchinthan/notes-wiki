{
    "title": "operand fetch format",
    "html": "<div class=\"markdown prose w-full break-words dark:prose-invert dark\"><h3 data-start=\"0\" data-end=\"65\" class=\"\"><strong data-start=\"4\" data-end=\"63\">Summary &amp; Explanation: Operand Fetch Unit in SimpleRisc</strong></h3>\n<h4 data-start=\"67\" data-end=\"108\" class=\"\"><strong data-start=\"72\" data-end=\"108\">1. SimpleRisc Instruction Format</strong></h4>\n<p data-start=\"109\" data-end=\"175\" class=\"\">SimpleRisc is a regular instruction set with three main formats:</p>\n<ul data-start=\"176\" data-end=\"446\">\n<li data-start=\"176\" data-end=\"261\" class=\"\" style=\"\">\n<p data-start=\"178\" data-end=\"261\" class=\"\"><strong data-start=\"178\" data-end=\"196\">Branch format:</strong> Contains an opcode and an offset (used for jump instructions).</p>\n</li>\n<li data-start=\"262\" data-end=\"342\" class=\"\" style=\"\">\n<p data-start=\"264\" data-end=\"342\" class=\"\"><strong data-start=\"264\" data-end=\"284\">Register format:</strong> Uses two source registers and one destination register.</p>\n</li>\n<li data-start=\"343\" data-end=\"446\" class=\"\" style=\"\">\n<p data-start=\"345\" data-end=\"446\" class=\"\"><strong data-start=\"345\" data-end=\"366\">Immediate format:</strong> Uses one source register and an immediate value instead of a second register.</p>\n</li>\n</ul>\n<p data-start=\"448\" data-end=\"741\" class=\"\">Each instruction type is identified by the <strong data-start=\"491\" data-end=\"511\">I-bit (27th bit)</strong>, which determines if an immediate value is used. The instruction set includes arithmetic operations (add, sub, mul, etc.), logic operations (and, or, not), memory operations (ld, st), and control flow operations (b, call, ret).</p>\n<hr data-start=\"743\" data-end=\"746\" class=\"\" style=\"\">\n<h4 data-start=\"748\" data-end=\"788\" class=\"\"><strong data-start=\"753\" data-end=\"788\">2. Operand Fetch Unit Functions</strong></h4>\n<p data-start=\"789\" data-end=\"838\" class=\"\">The operand fetch unit performs two main tasks:</p>\n<ol data-start=\"839\" data-end=\"942\">\n<li data-start=\"839\" data-end=\"896\" class=\"\" style=\"\">\n<p data-start=\"842\" data-end=\"896\" class=\"\"><strong data-start=\"842\" data-end=\"894\">Computes the immediate operand and branch target</strong></p>\n</li>\n<li data-start=\"897\" data-end=\"942\" class=\"\" style=\"\">\n<p data-start=\"900\" data-end=\"942\" class=\"\"><strong data-start=\"900\" data-end=\"940\">Reads the values of source registers</strong></p>\n</li>\n</ol>\n<h5 data-start=\"944\" data-end=\"1004\" class=\"\"><strong data-start=\"950\" data-end=\"1004\">a) Computing the Immediate Operand &amp; Branch Target</strong></h5>\n<ul data-start=\"1005\" data-end=\"1724\">\n<li data-start=\"1005\" data-end=\"1346\" class=\"\" style=\"\">\n<p data-start=\"1007\" data-end=\"1038\" class=\"\"><strong data-start=\"1007\" data-end=\"1036\">Immediate Operand (immx):</strong></p>\n<ul data-start=\"1041\" data-end=\"1346\">\n<li data-start=\"1041\" data-end=\"1089\" class=\"\" style=\"\">\n<p data-start=\"1043\" data-end=\"1089\" class=\"\">Extracts <strong data-start=\"1052\" data-end=\"1065\">bits 1-18</strong> from the instruction.</p>\n</li>\n<li data-start=\"1092\" data-end=\"1346\" class=\"\" style=\"\">\n<p data-start=\"1094\" data-end=\"1164\" class=\"\">Depending on modifiers (bit 17, 18), extends it into a 32-bit value.</p>\n<ul data-start=\"1169\" data-end=\"1346\">\n<li data-start=\"1169\" data-end=\"1221\" class=\"\" style=\"\">\n<p data-start=\"1171\" data-end=\"1221\" class=\"\"><strong data-start=\"1171\" data-end=\"1186\">No modifier</strong> â†’ Sign-extend the lower 16 bits.</p>\n</li>\n<li data-start=\"1226\" data-end=\"1276\" class=\"\" style=\"\">\n<p data-start=\"1228\" data-end=\"1276\" class=\"\"><strong data-start=\"1228\" data-end=\"1242\">u modifier</strong> â†’ Fill the top 16 bits with 0s.</p>\n</li>\n<li data-start=\"1281\" data-end=\"1346\" class=\"\" style=\"\">\n<p data-start=\"1283\" data-end=\"1346\" class=\"\"><strong data-start=\"1283\" data-end=\"1297\">h modifier</strong> â†’ Shift the 16-bit value left by 16 positions.</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li data-start=\"1348\" data-end=\"1724\" class=\"\" style=\"\">\n<p data-start=\"1350\" data-end=\"1397\" class=\"\"><strong data-start=\"1350\" data-end=\"1395\">Branch Target Calculation (branchTarget):</strong></p>\n<ul data-start=\"1400\" data-end=\"1724\">\n<li data-start=\"1400\" data-end=\"1440\" class=\"\" style=\"\">\n<p data-start=\"1402\" data-end=\"1440\" class=\"\">Extracts <strong data-start=\"1411\" data-end=\"1424\">bits 1-27</strong> as an offset.</p>\n</li>\n<li data-start=\"1443\" data-end=\"1502\" class=\"\" style=\"\">\n<p data-start=\"1445\" data-end=\"1502\" class=\"\">Shifts left by <strong data-start=\"1460\" data-end=\"1470\">2 bits</strong> (since offsets are in words).</p>\n</li>\n<li data-start=\"1505\" data-end=\"1537\" class=\"\" style=\"\">\n<p data-start=\"1507\" data-end=\"1537\" class=\"\">Sign-extends to <strong data-start=\"1523\" data-end=\"1534\">32 bits</strong>.</p>\n</li>\n<li data-start=\"1540\" data-end=\"1612\" class=\"\" style=\"\">\n<p data-start=\"1542\" data-end=\"1612\" class=\"\"><strong data-start=\"1542\" data-end=\"1560\">Adds to the PC</strong> (Program Counter) for <strong data-start=\"1583\" data-end=\"1609\">PC-relative addressing</strong>.</p>\n</li>\n<li data-start=\"1615\" data-end=\"1724\" class=\"\" style=\"\">\n<p data-start=\"1617\" data-end=\"1724\" class=\"\">If it's a <code data-start=\"1627\" data-end=\"1632\">ret</code> instruction, the branch target is read from the <strong data-start=\"1681\" data-end=\"1713\">ra (return address) register</strong> instead.</p>\n</li>\n</ul>\n</li>\n</ul>\n<p data-start=\"1726\" data-end=\"1892\" class=\"\">âœ… <strong data-start=\"1728\" data-end=\"1748\">Key Optimization</strong>: Both <code data-start=\"1755\" data-end=\"1761\">immx</code> and <code data-start=\"1766\" data-end=\"1780\">branchTarget</code> are computed <strong data-start=\"1794\" data-end=\"1818\">for all instructions</strong>, even if only one is needed. This improves speed but wastes some power.</p>\n<hr data-start=\"1894\" data-end=\"1897\" class=\"\" style=\"\">\n<h5 data-start=\"1899\" data-end=\"1938\" class=\"\"><strong data-start=\"1905\" data-end=\"1938\">b) Register Reading Mechanism</strong></h5>\n<ul data-start=\"1939\" data-end=\"2520\">\n<li data-start=\"1939\" data-end=\"2103\" class=\"\" style=\"\">\n<p data-start=\"1941\" data-end=\"1967\" class=\"\">The <strong data-start=\"1945\" data-end=\"1962\">register file</strong> has:</p>\n<ul data-start=\"1970\" data-end=\"2103\">\n<li data-start=\"1970\" data-end=\"1988\" class=\"\" style=\"\">\n<p data-start=\"1972\" data-end=\"1988\" class=\"\"><strong data-start=\"1972\" data-end=\"1988\">16 registers</strong></p>\n</li>\n<li data-start=\"1991\" data-end=\"2053\" class=\"\" style=\"\">\n<p data-start=\"1993\" data-end=\"2053\" class=\"\"><strong data-start=\"1993\" data-end=\"2009\">2 read ports</strong> (to read up to two operands simultaneously)</p>\n</li>\n<li data-start=\"2056\" data-end=\"2103\" class=\"\" style=\"\">\n<p data-start=\"2058\" data-end=\"2103\" class=\"\"><strong data-start=\"2058\" data-end=\"2074\">1 write port</strong> (not shown in the diagram)</p>\n</li>\n</ul>\n</li>\n<li data-start=\"2105\" data-end=\"2301\" class=\"\" style=\"\">\n<p data-start=\"2107\" data-end=\"2133\" class=\"\"><strong data-start=\"2107\" data-end=\"2131\">First operand (op1):</strong></p>\n<ul data-start=\"2136\" data-end=\"2301\">\n<li data-start=\"2136\" data-end=\"2180\" class=\"\" style=\"\">\n<p data-start=\"2138\" data-end=\"2180\" class=\"\">Normally read from <strong data-start=\"2157\" data-end=\"2177\">rs1 (bits 19-22)</strong>.</p>\n</li>\n<li data-start=\"2183\" data-end=\"2241\" class=\"\" style=\"\">\n<p data-start=\"2185\" data-end=\"2241\" class=\"\">If the instruction is <code data-start=\"2207\" data-end=\"2212\">ret</code>, read from <strong data-start=\"2224\" data-end=\"2230\">ra</strong> instead.</p>\n</li>\n<li data-start=\"2244\" data-end=\"2301\" class=\"\" style=\"\">\n<p data-start=\"2246\" data-end=\"2301\" class=\"\"><strong data-start=\"2246\" data-end=\"2267\">Multiplexer (MUX)</strong> decides between <code data-start=\"2284\" data-end=\"2289\">rs1</code> and <code data-start=\"2294\" data-end=\"2298\">ra</code>.</p>\n</li>\n</ul>\n</li>\n<li data-start=\"2303\" data-end=\"2520\" class=\"\" style=\"\">\n<p data-start=\"2305\" data-end=\"2332\" class=\"\"><strong data-start=\"2305\" data-end=\"2330\">Second operand (op2):</strong></p>\n<ul data-start=\"2335\" data-end=\"2520\">\n<li data-start=\"2335\" data-end=\"2379\" class=\"\" style=\"\">\n<p data-start=\"2337\" data-end=\"2379\" class=\"\">Normally read from <strong data-start=\"2356\" data-end=\"2376\">rs2 (bits 15-18)</strong>.</p>\n</li>\n<li data-start=\"2382\" data-end=\"2460\" class=\"\" style=\"\">\n<p data-start=\"2384\" data-end=\"2460\" class=\"\">If the instruction is <code data-start=\"2406\" data-end=\"2410\">st</code> (store), read from <strong data-start=\"2430\" data-end=\"2449\">rd (bits 23-26)</strong> instead.</p>\n</li>\n<li data-start=\"2463\" data-end=\"2520\" class=\"\" style=\"\">\n<p data-start=\"2465\" data-end=\"2520\" class=\"\"><strong data-start=\"2465\" data-end=\"2486\">Multiplexer (MUX)</strong> decides between <code data-start=\"2503\" data-end=\"2508\">rs2</code> and <code data-start=\"2513\" data-end=\"2517\">rd</code>.</p>\n</li>\n</ul>\n</li>\n</ul>\n<p data-start=\"2522\" data-end=\"2721\" class=\"\">âœ… <strong data-start=\"2524\" data-end=\"2545\">Key Design Choice</strong>: The unit <strong data-start=\"2556\" data-end=\"2566\">always</strong> reads register values, even if they are not required, to keep decoding simple. This slightly increases power consumption but reduces circuit complexity.</p>\n<hr data-start=\"2723\" data-end=\"2726\" class=\"\" style=\"\">\n<h4 data-start=\"2728\" data-end=\"2780\" class=\"\"><strong data-start=\"2733\" data-end=\"2780\">3. Overall Operand Fetch Stage (Figure 9.7)</strong></h4>\n<p data-start=\"2781\" data-end=\"2871\" class=\"\">The <strong data-start=\"2785\" data-end=\"2807\">operand fetch unit</strong> connects the instruction fetch, execution, and control units.</p>\n<ul data-start=\"2872\" data-end=\"3198\">\n<li data-start=\"2872\" data-end=\"2962\" class=\"\" style=\"\">\n<p data-start=\"2874\" data-end=\"2962\" class=\"\"><strong data-start=\"2874\" data-end=\"2885\">Inputs:</strong> Instruction (<code data-start=\"2899\" data-end=\"2905\">inst</code>), PC (<code data-start=\"2912\" data-end=\"2916\">pc</code>), register file (<code data-start=\"2934\" data-end=\"2939\">rs1</code>, <code data-start=\"2941\" data-end=\"2946\">rs2</code>, <code data-start=\"2948\" data-end=\"2952\">rd</code>, <code data-start=\"2954\" data-end=\"2958\">ra</code>).</p>\n</li>\n<li data-start=\"2963\" data-end=\"3198\" class=\"\" style=\"\">\n<p data-start=\"2965\" data-end=\"2979\" class=\"\"><strong data-start=\"2965\" data-end=\"2977\">Outputs:</strong></p>\n<ul data-start=\"2982\" data-end=\"3198\">\n<li data-start=\"2982\" data-end=\"3019\" class=\"\" style=\"\">\n<p data-start=\"2984\" data-end=\"3019\" class=\"\"><code data-start=\"2984\" data-end=\"2989\">op1</code>, <code data-start=\"2991\" data-end=\"2996\">op2</code> â†’ Register operands.</p>\n</li>\n<li data-start=\"3022\" data-end=\"3060\" class=\"\" style=\"\">\n<p data-start=\"3024\" data-end=\"3060\" class=\"\"><code data-start=\"3024\" data-end=\"3030\">immx</code> â†’ Computed immediate value.</p>\n</li>\n<li data-start=\"3063\" data-end=\"3108\" class=\"\" style=\"\">\n<p data-start=\"3065\" data-end=\"3108\" class=\"\"><code data-start=\"3065\" data-end=\"3079\">branchTarget</code> â†’ Computed branch address.</p>\n</li>\n<li data-start=\"3111\" data-end=\"3198\" class=\"\" style=\"\">\n<p data-start=\"3113\" data-end=\"3198\" class=\"\">Opcode and I-bit are sent to the <strong data-start=\"3146\" data-end=\"3162\">control unit</strong> for further instruction decoding.</p>\n</li>\n</ul>\n</li>\n</ul>\n<hr data-start=\"3200\" data-end=\"3203\" class=\"\" style=\"\">\n<h3 data-start=\"3205\" data-end=\"3226\" class=\"\"><strong data-start=\"3209\" data-end=\"3226\">Key Takeaways</strong></h3>\n<ol data-start=\"3227\" data-end=\"3653\">\n<li data-start=\"3227\" data-end=\"3310\" class=\"\" style=\"\">\n<p data-start=\"3230\" data-end=\"3310\" class=\"\"><strong data-start=\"3230\" data-end=\"3269\">Immediate values and branch targets</strong> are precomputed to speed up execution.</p>\n</li>\n<li data-start=\"3311\" data-end=\"3379\" class=\"\" style=\"\">\n<p data-start=\"3314\" data-end=\"3379\" class=\"\"><strong data-start=\"3314\" data-end=\"3349\">Register values are always read</strong> to keep the circuit simple.</p>\n</li>\n<li data-start=\"3380\" data-end=\"3509\" class=\"\" style=\"\">\n<p data-start=\"3383\" data-end=\"3509\" class=\"\"><strong data-start=\"3383\" data-end=\"3407\">Multiplexers (MUXes)</strong> handle special cases like <code data-start=\"3434\" data-end=\"3439\">ret</code> (uses <code data-start=\"3446\" data-end=\"3450\">ra</code> instead of <code data-start=\"3462\" data-end=\"3467\">rs1</code>) and <code data-start=\"3473\" data-end=\"3477\">st</code> (uses <code data-start=\"3484\" data-end=\"3488\">rd</code> instead of <code data-start=\"3500\" data-end=\"3505\">rs2</code>).</p>\n</li>\n<li data-start=\"3510\" data-end=\"3653\" class=\"\" style=\"\">\n<p data-start=\"3513\" data-end=\"3653\" class=\"\"><strong data-start=\"3513\" data-end=\"3542\">Speed vs. Power Tradeoff:</strong> The design prioritizes <strong data-start=\"3566\" data-end=\"3586\">faster execution</strong> over <strong data-start=\"3592\" data-end=\"3612\">power efficiency</strong>, making decoding and fetching simpler.</p>\n</li>\n</ol>\n<p data-start=\"3655\" data-end=\"3710\" class=\"\">Would you like me to explain any part in more depth? ðŸ˜Š</p></div>"
}